<!-- @license Copyright (c) 2016 The Polymer Project Authors. All rights reserved. This code may only be used under the BSD style license found at http: //polymer.github.io/LICENSE.txt
The complete set of authors may be found at http: //polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http: //polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also subject to an additional IP rights grant found at http: //polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/app-layout/app-drawer/app-drawer.html">
<link rel="import" href="../bower_components/app-layout/app-drawer-layout/app-drawer-layout.html">
<link rel="import" href="../bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="../bower_components/app-layout/app-header-layout/app-header-layout.html">
<link rel="import" href="../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">
<link rel="import" href="../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../bower_components/app-route/app-location.html">
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../bower_components/iron-selector/iron-selector.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="my-icons.html">
<link rel="import" href="../bower_components/app-storage/app-network-status-behavior.html">
<link rel="import" href="devocional-view.html">
<link rel="lazy-import" href="notas-view.html">
<link rel="lazy-import" href="my-view1.html">
<link rel="lazy-import" href="my-view2.html">
<link rel="lazy-import" href="my-view3.html">
<link rel="lazy-import" href="my-view404.html">
<dom-module id="my-app">
	<template>
		<style> 
			:host {
	--app-primary-color: #ffb300;
	--app-secondary-color: #8E5500;
	display: relative;
}

iron-icon {
	color: white;
}

iron app-drawer-layout:not([narrow]) [drawer-toggle] {
	display: none;
}

app-header {
	color: white;
	background-color: var(--app-primary-color);
}

app-header paper-icon-button {
	--paper-icon-button-ink-color: white;
	color: white;
}

.drawer-list {
	margin: 0 20px;
}

.dtoolbar {
	background-color: var(--app-primary-color, red);
	color: white;
	text-align: center;
	font-size: 40;
	height: 80px;
	
}

.drawer-list a {
	display: block;
	padding: 0 16px;
	text-decoration: none;
	color: var(--app-secondary-color);
	line-height: 80px;
}

.drawer-list a.iron-selected {
	color: var(--app-primary-color, black);
	font-weight: bold;
	font-size: 40;
}

</style>
	<app-location route="{{route}}" url-space-regex="^[[rootPath]]">
	</app-location>
	<app-route route="{{route}}" pattern="[[rootPath]]:page" data="{{routeData}}" tail="{{subroute}}">
	</app-route>
	<app-drawer-layout 
															fullbleed
										 narrow="{{narrow}}">
		<!-- Drawer content -->
		<app-drawer id="drawer" slot="drawer" swipe-open="[[narrow]]">
			<app-toolbar class="dtoolbar">
				<iron-icon icon="menu"></iron-icon>
        <div main-title style="text-align:center"><strong>Menu</strong></div>

        

			</app-toolbar>
			<iron-selector selected="[[page]]" attr-for-selected="name" class="drawer-list" role="navigation">
				<a name="devocional" href="[[rootPath]]devocional">Devocional</a>
				<a name="notas" href="[[rootPath]]notas">Notas</a>

				
				
			</iron-selector>
		</app-drawer>
		<!-- Main content --><app-header-layout has-scrolling-region><app-header slot="header" condenses reveals effects="waterfall"><app-toolbar><paper-icon-button icon="my-icons:menu" drawer-toggle></paper-icon-button><div main-title style="text-align:center"><strong>Cuaderno Devocional rhema</strong></div><iron-icon icon="cloud" hidden$="[[!online]]"></iron-icon><iron-icon icon="cloud-off" hidden$="[[online]]"></iron-icon><paper-icon-button icon="[[computeLockIcon(signedIn)]]" disabled="[[!signedIn]]" on-tap="lock"></paper-icon-button></app-toolbar></app-header><iron-pages selected="[[page]]" attr-for-selected="name" fallback-selection="view404" role="main"><devocional-view name="devocional"></devocional-view><notas-view name="notas"></notas-view><my-view1 name="view1"></my-view1><my-view2 name="view2"></my-view2><my-view3 name="view3"></my-view3><my-view404 name="view404"></my-view404></iron-pages></app-header-layout></app-drawer-layout></template>
	<script>
		// Gesture events like tap and track generated from touch will not be
		// preventable, allowing for better scrolling performance.
		Polymer.setPassiveTouchGestures(true);
		///========================Network Stuff===============================
		var networkStatusSubscribers = [];

		function notifySubscribers() {
			for (var i = 0; i < networkStatusSubscribers.length;
				++i) {
				networkStatusSubscribers[i].refreshNetworkStatus();
			}
		}

		window.addEventListener('online', notifySubscribers);
		window.addEventListener('offline', notifySubscribers);
		class MyApp extends Polymer.Element {
			static get is() {
				return 'my-app';
			}
			static get properties() {
				return {
					/**
					 * True if the browser is online, and false if the browser is offline
					 * matching the HTML browser state spec.
					 *
					 * @type {Boolean}
					 */
					online: {
						type: Boolean,
						readOnly: true,
						notify: true,
						value: function() {
							return window.navigator.onLine;
						}
					},
					signedIn: {
						type: Boolean,
						notify: true,
						value: false
					}, 
          barTitle:{
            type: String,
            value: "Menu"
          },
					page: {
						type: String,
						reflectToAttribute: true,
						observer: '_pageChanged',
					},
					routeData: Object,
					subroute: Object, // This shouldn't be neccessary, but the Analyzer isn't picking up
					// Polymer.Element#rootPath
					rootPath: String,
				};
			}
			/*================ appbar stuff========*/
			computeLockIcon(signedIn) {
				console.log("computing lock icon");
				return signedIn ? 'lock-open' : 'lock';
			}
			/*============network stuff===============*/
			attached() {
				networkStatusSubscribers.push(this);
				this.refreshNetworkStatus();
				console.debug("attached");
			}
			detached() {
				var index = networkStatusSubscribers.indexOf(this);
				if (index < 0) {
					return;
				}
				networkStatusSubscribers.splice(index, 1);
			}
			/**
			 * Updates the `online` property to reflect the browser connection status.
			 */
			refreshNetworkStatus() {
				this._setOnline(window.navigator.onLine);
				if (window.navigator.onLine) {
					console.debug("browser online");
				} else {
					console.debug("browser offline");
				}
			}
			/*===========================================*/
			static get observers() {
				return ['_routePageChanged(routeData.page)', ];
			}
			_routePageChanged(page) {
				// If no page was found in the route data, page will be an empty string.
				// Default to 'devocional' in that case.
				this.page = page || 'devocional'; // Close a non-persistent drawer when the page & route are changed.
				if (!this.$.drawer.persistent) {
					this.$.drawer.close();
				}
			}
			_pageChanged(page) {
				// Load page import on demand. Show 404 page if fails
				console.debug("page: " + page); //old resolver
				//const resolvedPageUrl = this.resolveUrl('my-' + page + '.html');
				//new page resolver
				const resolvedPageUrl = this.resolveUrl(page + '-view' + '.html');
				Polymer.importHref(resolvedPageUrl, null, this._showPage404.bind(this), true);
			}
			_showPage404() {
				this.page = 'view404';
			}
			constructor() {
				super(); // attached();
			}
		}

		window.customElements.define(MyApp.is, MyApp);
	</script>
</dom-module>